<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="build-install-bundle" name="ogrsh-release">

	<property file="release.properties"/>
	<property file="build-installer.properties"/>

	<taskdef name="izpack"
		classpath="${basedir}/../installer/IzPack/lib/compiler.jar"
		classname="com.izforge.izpack.ant.IzPackTask"/>

	<target name="clean" depends="cleanup-install, clean.x86, clean.x86-64"/>

	<target name="cleanup-install">
		<delete
			dir="${basedir}/installers"
			quiet="true"/>
	</target>

	<target name="build-install-bundle"
		depends="compile-code.x86, compile-code.x86-64, init">
		<buildnumber/>
		<izpack input="${basedir}/installer-desc.xml"
			output="${basedir}/installers/OGRSH-installer-${ogrsh.version}.jar"
			installerType="standard" basedir="${basedir}"
			izPackDir="${basedir}/../installer/IzPack"/>
	</target>

	<target name="init">
		<mkdir dir="${basedir}/installers"/>
	</target>
	
	<target name="compile-code.x86">
		<ant antfile="build.xml" dir="${basedir}" inheritAll="false">
			<target name="build"/>
			<property name="ogrsh-arch" value="x86"/>
		</ant>
	</target>

	<target name="compile-code.x86-64">
		<ant antfile="build.xml" dir="${basedir}" inheritAll="false">
			<target name="build"/>
			<property name="ogrsh-arch" value="x86-64"/>
		</ant>
	</target>

	<target name="clean.x86">
		<ant antfile="build.xml" dir="${basedir}" inheritAll="false">
			<target name="clean"/>
			<property name="ogrsh-arch" value="x86"/>
		</ant>
	</target>

	<target name="clean.x86-64">
		<ant antfile="build.xml" dir="${basedir}" inheritAll="false">
			<target name="clean"/>
			<property name="ogrsh-arch" value="x86-64"/>
		</ant>
	</target>

</project>
