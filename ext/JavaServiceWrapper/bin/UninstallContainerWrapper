# Copyright (c) 1999, 2006 Tanuki Software Inc.
#
# Java Service Wrapper Linux uninstall script
#

usageExit()
{
	echo "Usage: UninstallContainerWrapper <deployment name> <container service name>"
	exit -1
}


_UCW_GENII_INSTALL_DIR="%{INSTALL_PATH}"
_UCW_LOCAL_JAVA_DIR="$_UCW_GENII_INSTALL_DIR/Java/linux-i586/jre"

# get user's data directory...
_GENII_USER_DIR=`$_UCW_LOCAL_JAVA_DIR/bin/java -classpath "$_UCW_GENII_INSTALL_DIR/lib/GenesisII-client.jar:$_UCW_GENII_INSTALL_DIR/lib/morgan-utilities.jar" edu.virginia.vcgr.genii.client.cmd.GetUserDir`
echo "_GENII_USER_DIR is now set to ....     $_GENII_USER_DIR"

# check if deployment name arg was passed in
_DEPLOYMENT_NAME="$1"
if [ "x$_DEPLOYMENT_NAME" = "x" ] 
then
	echo Missing deployment name argument
	usageExit
fi

# check if container name arg was passed in
_CONTAINER_NAME="$2"
if [ "x$_CONTAINER_NAME" = "x" ] 
then
	echo Missing container name argument
	usageExit
fi

#
# figure out path to script for init.d to manage this container
#
_MANAGE_CONTAINER_SCRIPT_PATH="$_UCW_GENII_INSTALL_DIR/$_CONTAINER_NAME-manage-script"
echo "Removing init.d script $_MANAGE_CONTAINER_SCRIPT_PATH"
rm -f "$_MANAGE_CONTAINER_SCRIPT_PATH"

# get user's data directory...
_GENII_USER_DIR=`$_UCW_LOCAL_JAVA_DIR/bin/java -classpath "$_UCW_GENII_INSTALL_DIR/lib/GenesisII-client.jar:$_UCW_GENII_INSTALL_DIR/lib/morgan-utilities.jar" edu.virginia.vcgr.genii.client.cmd.GetUserDir`
echo "_GENII_USER_DIR is now set to ....     $_GENII_USER_DIR"

# remove container console output file if it exists 
_CONTAINER_OUTPUT_PATH="$_CONTAINER_DIR/container.out"
echo "Removing container console output file $_CONTAINER_OUTPUT_PATH"
rm -f "$_CONTAINER_OUTPUT_PATH"
