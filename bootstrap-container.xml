<?xml version="1.0" encoding="utf-8" ?>
<gsh:script
	xmlns:gsh="http://vcgr.cs.virginia.edu/genii/xsh/script"
	xmlns:geniix="http://vcgr.cs.virginia.edu/genii/xsh/grid">

	<gsh:define name="TARGET_DIR"
		source="/uninitialized-containers"/>
	
	<gsh:echo
		message="GENII_INSTALL_DIR is ${GENII_INSTALL_DIR}"/>
	<gsh:echo
		message="DEPLOYMENT_NAME is ${DEPLOYMENT_NAME}"/>
	<gsh:echo
		message="CONTAINER_NAME is ${CONTAINER_NAME}"/>
	<gsh:echo
		message="CONTAINER_ADDR is ${CONTAINER_ADDR}"/>

	<gsh:echo
		message="Logging in using container cert - ${GENII_INSTALL_DIR}/deployments/${DEPLOYMENT_NAME}/security/container.pfx."/>
	<geniix:login>
		<gsh:param>--no-gui</gsh:param>
		<gsh:param>${GENII_INSTALL_DIR}/deployments/${DEPLOYMENT_NAME}/security/container.pfx</gsh:param>
		<gsh:param>--password=container</gsh:param>
		<gsh:param>--pattern=container</gsh:param>
		<gsh:param>--alias</gsh:param>
	</geniix:login>

	<gsh:echo
		message="Logging in using installer cert - ${GENII_INSTALL_DIR}/deployments/${DEPLOYMENT_NAME}/security/container.pfx."/>
	<geniix:login>
		<gsh:param>--no-gui</gsh:param>
		<gsh:param>${GENII_INSTALL_DIR}/deployments/${DEPLOYMENT_NAME}/security/installer.pfx</gsh:param>
		<gsh:param>--pattern=installer</gsh:param>
		<gsh:param>--alias</gsh:param>
	</geniix:login>

	<gsh:echo message="Attaching host as ${CONTAINER_NAME}"/>
	<geniix:attach-host>
		<gsh:param>${CONTAINER_ADDR}/axis/services/VCGRContainerPortType</gsh:param>
		<gsh:param>${TARGET_DIR}/${CONTAINER_NAME}</gsh:param>
	</geniix:attach-host>

	<gsh:echo message="Logging out"/>
	<geniix:logout>
		<gsh:param>--all</gsh:param>
	</geniix:logout>
</gsh:script>
